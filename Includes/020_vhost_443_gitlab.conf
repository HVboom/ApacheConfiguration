<VirtualHost *:443>
  ServerName GitLab.HVboom.org
  DocumentRoot "/home/git/gitlab/public"
  # Necessary to find used scripts like the "bash" shell
  PassengerLoadShellEnvvars on

  # Do not use the default ruby
  # PassengerRuby /home/git/.rvm/wrappers/ruby-2.3.3/ruby

  RailsBaseURI "/"
  <Directory "/home/git/gitlab/public">
    Require all granted
    Options -MultiViews 
  </Directory>

  SSLEngine on
  SSLCertificateFile      /usr/local/etc/letsencrypt/live/hvboom.org/fullchain.pem
  SSLCertificateKeyFile   /usr/local/etc/letsencrypt/live/hvboom.org/privkey.pem
  
  <IfModule headers_module>
    Header always edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure
    Header always set Strict-Transport-Security "max-age=15768000; includeSubDomains"
  </IfModule>
</VirtualHost>

<VirtualHost *:80>
  ServerName GitLab.HVboom.org
  RewriteEngine on
  RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,QSA,R=permanent]
</VirtualHost>
